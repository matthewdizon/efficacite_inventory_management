{% extends 'main_app/base.html' %}

{% block content %}
{% load static %}

<div class="card w-75">
    <div class="card-header">
        Enter Product Details: 
    </div>
    <form method="POST" action="{% url 'add_product' %}" style="padding-left: 10; padding-right: 10;">{% csrf_token %}
        <div class="d-flex flex-row mt-2">
            <div class="form-group w-50">
                <label for="name" > Product Name: </label>
                {{ product_form.name }}
                {% if product_form.name.errors %}
                    {% for error in product_form.name.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}
            </div>

            <div class="form-group w-50 mx-4">
                <label for="name"> Description: </label>
                {{ product_form.description }}
                {% if product_form.description.errors %}
                    {% for error in product_form.description.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}
            </div>
        </div>

        <div class="d-flex flex-row">
            <div class="form-group w-50">
                <label for="name"> Price (â‚±): </label>
                {{ product_form.price }}
                {% if product_form.price.errors %}
                    {% for error in product_form.price.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}
            </div>
        </div>

        {{ product_ingredient_formset.management_form }}

        {% for form in product_ingredient_formset %}
            <div class="product-ingredient-formset">
                <label for="name"> Ingredient </label>
                {{ form.ingredient }}
                {% if form.ingredient.errors %}
                    {% for error in form.ingredient.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}

                <label for="name"> Quantity: </label>
                {{ form.qty }}
                {% if form.qty.errors %}
                    {% for error in form.qty.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}
            </div>
        {% endfor %}

        {% if product_ingredient_formset.non_form_errors %}
            {% for error in product_ingredient_formset.non_form_errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}

        <input type="hidden" name="message" value="Food created successfully">

        <a href="{% url 'add_product' %}"><button type="submit" class="btn btn-dark-grabgrub float-right mr-4" >Add Product</button></a>
    </form>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="{% static 'src/jquery.formset.js' %}"></script>
    <script>
        $('.product-ingredient-formset').formset({
            addText: 'Add Ingredient',
            deleteText: 'Remove'
        });
    </script>
</div>
<a href="{% url 'product_index' %}"><button class="btn btn-grabgrub mt-3">Back</button></a>
{% endblock %}